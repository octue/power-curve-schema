{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "title": "Turbine Power Curves",
  "description": "Define a set of power curves for a wind turbine.",
  "definitions": {
    "1darray": {
      "type": "array",
      "items": {
        "type": "number"
      },
      "additionalItems": true
    },
    "2darray": {
      "type": "array",
      "items": {
        "type": "array",
        "items": {
          "type": "number"
        },
        "additionalItems": true
      },
      "additionalItems": true
    },
    "3darray": {
      "type": "array",
      "items": {
        "type": "array",
        "items": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "additionalItems": true
        },
        "additionalItems": true
      },
      "additionalItems": true
    },
    "4darray": {
      "type": "array",
      "items": {
        "type": "array",
        "items": {
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "type": "number"
            },
            "additionalItems": true
          },
          "additionalItems": true
        },
        "additionalItems": true
      },
      "additionalItems": true
    }
  },
  "required": ["document", "turbine", "design_bases", "power_curves"],
  "properties": {
    "document": {
      "type": "object",
      "title": "Document",
      "description": "Information about this document",
      "required": ["metadata"],
      "properties": {
        "metadata": {
          "title": "Dublin-Core Metadata",
          "description": "Add metadata according to the Dublin Core Metadata Initiative (DCMI) elements/1.1. See https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#section-3 for detailed information on each element.",
          "type": "array",
          "items": {
            "type": "object",
            "required": ["term", "value"],
            "properties": {
              "term": {
                "type": "string",
                "title": "Term",
                "description": "The DCMI Element label",
                "enum": [
                  "Contributor",
                  "Coverage",
                  "Creator",
                  "Date",
                  "Description",
                  "Format",
                  "Identifier",
                  "Language",
                  "Publisher",
                  "Relation",
                  "Rights",
                  "Source",
                  "Subject",
                  "Type"
                ]
              },
              "value": {
                "type": "string",
                "title": "Value",
                "description": "The metadata value"
              }
            }
          }
        }
      }
    },
    "turbine": {
      "type": "object",
      "title": "Turbine",
      "description": "General information about the physical turbine and its default operational values",
      "required": [
        "model_name",
        "manufacturer_name",
        "manufacturer_display_name",
        "rated_power",
        "rated_rpm",
        "cut_in_rpm",
        "rotor_diameter",
        "model_description",
        "available_hub_heights",
        "drive_type",
        "regulation_type",
        "grid_frequencies"
      ],
      "properties": {
        "manufacturer_name": {
          "type": "string",
          "title": "Manufacturer name",
          "description": "Full name of the manufacturer (eg a legal entity)",
          "minLength": 1,
          "examples": ["Generic Turbines (US) Inc."]
        },
        "manufacturer_display_name": {
          "type": "string",
          "title": "Manufacturer display name",
          "description": "Shortened or informal name of the manufacturer (for display purposes, eg in dropdown selectors). See also manufacturer_name.",
          "maxLength": 40,
          "minLength": 1,
          "examples": ["Generic Turbines"]
        },
        "model_name": {
          "type": "string",
          "title": "Model name",
          "description": "Name of the turbine model as stated on the Type Certificate, Design Evaluation Confirmity Statement or Statement of Compliance.",
          "minLength": 1,
          "maxLength": 40,
          "examples": ["GT101"]
        },
        "model_description": {
          "type": "string",
          "title": "Model description",
          "description": "General description about the turbine model, eg for giving a brief overview in a turbine selection tool.",
          "examples": ["An example simple turbine with only one mode."]
        },
        "platform_name": {
          "type": "string",
          "title": "Platform name",
          "description": "Optional name of the platform on which this turbine model is based.",
          "maxLength": 40,
          "examples": ["1.x Series"]
        },
        "platform_description": {
          "type": "string",
          "title": "Platform description",
          "description": "Optional general description of the platform on which this turbine model is based.",
          "examples": [
            "The 1.x Series platform was designed as a basis for a range of small-scale onshore turbines versatile for a range of site conditions."
          ]
        },
        "rotor_diameter": {
          "type": "number",
          "title": "Rotor diameter [m]",
          "description": "Nominal rotor diameter of the turbine [m]",
          "examples": [100.0],
          "exclusiveMinimum": 0,
          "exclusiveMaximum": 1000
        },
        "drive_type": {
          "type": "string",
          "title": "Drive type",
          "description": "The drive type of the turbine",
          "enum": ["geared", "direct", "other"]
        },
        "regulation_type": {
          "type": "string",
          "title": "Regulation type",
          "description": "The regulation type of the turbine.",
          "enum": ["pitch", "stall", "other"]
        },
        "rated_power": {
          "type": "number",
          "title": "Rated power [W]",
          "description": "Nominal rated power of the turbine in W. Used for preliminary sizing and search. This value may be overridden on a per-mode basis.",
          "examples": [5000000]
        },
        "cut_in_rpm": {
          "type": "number",
          "title": "Rotational speed at cut-in [RPM]",
          "description": "Nominal rotational speed at cut-in (specify 0 for stall-regulated devices) [RPM]. This value may be overriden on a per-mode basis.",
          "examples": [2]
        },
        "rated_rpm": {
          "type": "number",
          "title": "Rotational speed at rated power [RPM]",
          "description": "Nominal rotational speed at rated power (or at peak power for stall-regulated devices) [RPM]. This value may be overriden on a per-mode basis.",
          "examples": [12]
        },
        "available_hub_heights": {
          "title": "Available hub heights",
          "description": "Specify either a discrete list or a continuous range of available hub heights [m]. This value may be overriden on a per-mode basis.",
          "anyOf": [
            {
              "title": "Specify a range of available hub heights [m]",
              "type": "object",
              "description": "Specify a range of available hub heights [m]",
              "properties": {
                "min": {
                  "type": "number",
                  "description": "Minium hub height [m]"
                },
                "max": {
                  "type": "number",
                  "description": "Maximum hub height [m]"
                }
              },
              "required": ["min"]
            },
            {
              "title": "Specify a list of discrete available hub heights [m]",
              "type": "array",
              "description": "Specify a list of discrete available hub heights [m]",
              "items": {
                "type": "number"
              }
            }
          ],
          "examples": [
            {
              "min": 120,
              "max": 180
            },
            [120, 180]
          ]
        },
        "grid_frequencies": {
          "title": "Grid frequencies [Hz]",
          "description": "The allowable design grid frequencies in Hz",
          "type": "array",
          "items": {
            "type": "number", "exclusiveMinimum": 0
          },
          "examples": [[50], [50, 60]]
        }
      }
    },
    "design_bases": {
      "title": "Design bases",
      "description": "A list of design bases for turbine certification or describing site-specific environmental conditions. Each contains information about the design point (environmental conditions) for which the power curves in this document are intended.",
      "type": "array",
      "items": {
        "type": "object",
        "required": ["label", "name", "design_class", "turbulence", "standard_climate"],
        "properties": {
          "label": {
            "type": "string",
            "title": "Basis label",
            "description": "A string key identifying the design basis, eg `my_design_basis_1`",
            "pattern": "^[a-z0-9_]{1,40}$",
            "minLength": 1,
            "maxLength": 40,
            "examples": ["basis_1", "basis_2", "site_xyz_specific"]
          },
          "name": {
            "type": "string",
            "title": "Basis name",
            "description": "A human-readable name matching this basis label (eg for use in UIs)",
            "minLength": 1,
            "maxLength": 80,
            "examples": ["Basis 1", "Basis 2", "Site XYZ Specific"]
          },
          "certification": {
            "type":"object",
            "title": "Certification details",
            "description": "Information about the scheme under which this design basis was certified. This is not a required property, so if a turbine is as-yet uncertified, simply leave it out.",
            "$comment": "We collect these three under a single 'certification' property as a convenitent way to require that either all or none are given",
            "required": ["standard", "standard_edition","certificate_reference"],
            "examples": [
              {
                "certificate_reference": "IECRE.WE.TC.20.0099-R6",
                "standard": "IEC",
                "standard_edition": "2"
              }
            ],
            "properties": {
              "standard": {
                "$comment": "Note - use of anyOf allows specification of any string value, but adding an enum indicates the precise values to be selected should your value be in the prescribed list",
                "description": "The certification scheme under which the power curves were certified.",
                "anyOf": [{"title": "Choose predefined scheme","enum": ["IEC", "DiBT"] },{ "title": "Specify other scheme", "type": "string" }]
              },
              "standard_edition": {
                "$comment": "Note - use of anyOf allows specification of any string value, but adding an enum indicates the precise values to be selected should your value be in the prescribed list",
                "description": "The edition of the standard used in turbine certification",
                "type": "string",
                "anyOf": [{  "title": "Choose predefined standard edition","enum": ["2", "3", "4"] }, { "title": "Specify other standard edition", "type": "string" }]
              },
              "certificate_reference": {
                "type": "string",
                "title": "Certificate reference",
                "examples": [
                  "44 220 15454566-D-IEC Rev. 4",
                  "IECRE.WE.TC.86.0179-R6"
                ],
                "description": "Identifies the certificate associated with the power curve. Note that multiple design bases may refer to the same certificate.",
                "minLength": 1
              }
            }
          },
          "design_class": {
            "title": "Design class",
            "description": "A fully or partially predefined environmental class, (eg IEC or other scheme)",
            "type": "object",
            "oneOf": [
              { 
                "title": "Standard IEC design class",
                "type": "object",
                "required": ["class_label"],
                "properties": {
                  "class_label": {
                    "description": "Select from predefined IEC design classes I, II, and III.",
                    "enum": ["I", "II", "III"]
                  }     
                },
                "$comment": "S (T, CC to be confirmed) is a custom class, use other objects, what should we do for class IV turbines? Are they custom?"
              },
              { 
                "title": "Special or custom design class",
                "type": "object",
                "required": ["class_label"],
                "properties": {
                  "class_label": {
                    "title": "Label",
                    "description": "Specify IEC classes S, T, CC or an entirely custom design class",
                    "enum": ["S", "T", "CC", "Custom"]
                  },   
                  "annual_average_wind_speed": {
                    "type": "number",
                    "title": "Annual average wind speed 'Vave'",
                    "description": "The annualised average wind speed for which the turbine is certified [m/s]",
                    "examples": [10, 8.5, 7.5]
                  },
                  "annual_average_air_density": {
                    "type": "number",
                    "title": "Annual average air density 'rho'",
                    "description": "The annualised average air density for which the turbine is certified [kg/m^3]",
                    "examples": [1.15, 1.225, 1.25]
                  },
                  "reference_wind_speed": {
                    "type": "number",
                    "title": "Reference wind speed 'Vref'",
                    "description": "The 50-year return value of 10-minute average wind speed for which the turbine is certified [m/s]. Note: the Ve50 (the 3s gust wind speed) can be calculated from V50 according to the standard ratio",
                    "examples": [50, 42.5, 37.5]
                  },
                  "weibull_shape_factor": {
                    "type": "number",
                    "title": "Weibull shape factor, 'k'",
                    "description": "The Weibull distribution shape factor k [dimensionless]. Tip: You can calculate the Weibull scale factor, 'c', from the weibull_shape_factor and the annual_average_wind_speed.",
                    "examples": [1.5, 2, 2.5, 3, 3.5]
                  },
                  "vertical_shear_exponent": {
                    "type": "number",
                    "title": "Vertical shear exponent 'alpha'",
                    "description": "The design wind vertical shear exponent [dimensionless]",
                    "examples": [0.15, 0.3, 0.45, 0.6]
                  },
                  "inflow_angle": {
                    "title": "Inflow angle",
                    "description": "The design vertical inflow angle [degrees]",
                    "anyOf": [
                      {
                        "title": "Single inflow angle",
                        "type": "number"
                      },
                      {
                        "title": "Range of inflow angles",
                        "type": "object",
                        "properties": {
                          "min": {
                            "type": "number",
                            "exclusiveMinimum": -20,
                            "exclusiveMaximum": 20
                          },
                          "max": {
                            "type": "number",
                            "exclusiveMinimum": -20,
                            "exclusiveMaximum": 20
                          }
                        }
                      }
                    ],
                    "examples": [0, 2, {"min":-2, "max": 2}]
                  },
                  "design_lifetime": {
                    "$comment": "Schema team - check if this also needs to be given for T, CC classes as well as S class",
                    "title": "Design lifetime",
                    "description": "Designed lifetime of the turbine in years, typically 20. Note that some design classes require particular minimum lifetimes.",
                    "type": "number",
                    "exclusiveMinimum": 0,
                    "examples": [20, 30]
                  }
                }
              }
            ]
          },
          "turbulence": {
            "title": "Turbulence category or distribution",
            "description": "Specify the IEC turbulence category or one of several custom distributions.",
            "anyOf": [
              { 
                "title": "Standard IEC Turbulence Category",
                "type": "object",
                "$comment": "This is defined as a single-property object rather than a direct string because it's more explicit to include the category keyword (and allows for later adoption of other predefined profiles requiring more sophistication than a string)",
                "required": ["category"],
                "properties": {
                  "category": {
                    "title": "Category",
                    "description": "Specify a predefined IEC turbulence category", 
                    "enum": ["A+", "A", "B", "C"] 
                  }
                }
              },
              {
                "title": "Custom Iref and slope parameters",
                "type": "object",
                "description": "Specify custom fixed Iref and optional slope parameter",
                "required": ["category", "reference_turbulence_intensity"],
                "properties": {
                  "category": {
                    "title": "Category",
                    "description": "Specify the turbulence category to be custom", 
                    "enum": ["Custom"]
                  },
                  "reference_turbulence_intensity": {
                    "type": "number",
                    "title": "Turbulence intensity",
                    "description": "Characteristic Iref value at 15m/s, specified as a fraction (eg 0.13)",
                    "minimum": 0,
                    "maximum": 1
                  },
                  "slope": {
                    "type": "number",
                    "title": "Slope (a)",
                    "description": "Specify the slope parameter (a) for use with edition 2 definitions of turbulence. Typical values are 2 or 3. No slope parameter is used for editions 3 or 4.",
                    "minimum": 0
                  }
                }
              },
              {
                "title": "Normal and Extreme Turbulence Models varying with Wind Speed",
                "type": "object",
                "description": "Specify Normal and Extreme Turbulence Models (NTM, ETM) using turbulence intensity as a function of wind speed",
                "required": ["category", "wind_speed", "normal_turbulence_intensity", "extreme_turbulence_intensity"],
                "properties": {
                  "category": {
                    "title": "Category",
                    "description": "Specify the turbulence category as custom", 
                    "enum": ["Custom"] 
                  },
                  "wind_speed": {
                    "type": "array",
                    "title": "Wind Speed",
                    "description": "Wind speed in m/s for each entry in the Normal and Extreme Turbulence Model arrays. Wind speed range must cover the entire operating range (below cut-in to above maximum cut-out).",
                    "items": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 100
                    }
                  },
                  "normal_turbulence_intensity": {
                    "type": "array",
                    "title": "Normal Turbulence Intensity",
                    "description": "Normal value of I for each wind speed, specified as a fraction (eg 0.13)",
                    "items": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1
                    }
                  },
                  "extreme_turbulence_intensity": {
                    "type": "array",
                    "title": "Extreme Turbulence Intensity",
                    "description": "Extreme value of I for each wind speed, specified as a fraction (eg 0.13)",
                    "items": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1
                    }
                  }
                }
              },
              {
                "title": "Normal and Extreme Turbulence Models varying with Wind Speed and Lifetime Hours",
                "type": "object",
                "description": "Specify Normal Turbulence Model as a function of wind speed and lifetime hours and Extreme Turbulence Models (NTM, ETM) as a function of wind speed.",
                "required": ["category", "wind_speed", "normal_turbulence_intensity", "normal_hours_per_lifetime", "extreme_turbulence_intensity"],
                "$comment": "Schema team to check and add bin center values (there must be something on the X axis of this histogram) and further define what the bins are.",
                "properties": {
                  "category": {
                    "description": "Set the turbulence category to custom", 
                    "enum": ["Custom"] 
                  },
                  "wind_speed": {
                    "type": "array",
                    "title": "Wind Speed",
                    "description": "Wind speed in m/s for each entry in the Normal and Extreme Turbulence Model arrays. Wind speed range must cover the entire operating range (below cut-in to above maximum cut-out).",
                    "items": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 100
                    }
                  },
                  "normal_turbulence_intensity": {
                    "type": "array",
                    "title": "Normal Turbulence Intensity",
                    "description": "2d array containing normal value of I for each wind speed and hours bin, specified as a fraction (eg 0.13)",
                    "items": {
                      "type": "array",
                      "items": {
                        "minimum": 0,
                        "maximum": 1
                      }
                    }
                  },
                  "normal_hours_per_lifetime": {
                    "type": "array",
                    "title": "Normal hours per lifetime",
                    "description": "2d array containing the number of hours spent for each entry, through-life, in the normal_turbulence_intensity array",
                    "items": {
                      "type": "array",
                      "items": {
                        "minimum": 0
                      }
                    }
                  },
                  "extreme_turbulence_intensity": {
                    "type": "array",
                    "title": "Extreme Turbulence Intensity",
                    "description": "Extreme value of I for each wind speed, specified as a fraction (eg 0.13)",
                    "items": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1
                    }
                  }
                }
              }
            ],
            "examples": [
              { 
                "category": "A"
              },
              {
                "category": "Custom",
                "reference_turbulence_intensity": 0.13,
                "slope": 2
              },
              {
                "category": "Custom",
                "wind_speed": [1, 2, 25],
                "normal_turbulence_intensity": [0.85, 0.5, 0.11],
                "extreme_turbulence_intensity": [0.92, 0.6, 0.15]
              },
              {
                "category": "Custom",
                "wind_speed": [1, 2, 25],
                "normal_turbulence_intensity": [
                  [0.116, 0.1889, 0.2613, 0.3337, 0.46],
                  [0.116, 0.1889, 0.2613, 0.3337, 0.46],
                  [0.116, 0.1889, 0.2613, 0.3337, 0.46]
                ],
                "normal_hours_per_lifetime": [
                  [1633.89, 2145.8, 1551.13, 1434.6, 1321.1],
                  [804.2, 956.3, 756.3, 645.6,543.7],
                  [30.5, 60.4, 43.8, 38.5, 27.6]
                ],
                "extreme_turbulence_intensity": [0.92, 0.6, 0.15]
              }
            ]
          },
          "standard_climate": {
            "type": "object",
            "description": "Define operating and survival temperatures in standard (usual) climates",
            "properties": {
              "operating_temperature_range": {
                "type": "array",
                "items" : {
                  "type": "number",
                  "minimum": -273.15,
                  "maximum": 1000
                }
              },
              "survival_temperature_range": {
                "type": "array",
                "items" : {
                  "type": "number",
                  "minimum": -273.15,
                  "maximum": 1000
                }
              }
            },
            "examples": [
              {
                "operating_temperature_range": [-10, 40],
                "survival_temperature_range": [-20, 50]
              }
            ]
          },
          "cold_climate": {
            "type": "object",
            "description": "Define operating and survival temperatures in cold climates",
            "$comment": "Can we define why this is different in cold climates?",
            "properties": {
              "operating_temperature_range": {
                "type": "array",
                "items" : {
                  "type": "number",
                  "minimum": -273.15,
                  "maximum": 1000
                }
              },
              "survival_temperature_range": {
                "type": "array",
                "items" : {
                  "type": "number",
                  "minimum": -273.15,
                  "maximum": 1000
                }
              }
            },
            "examples": [
              {
                "operating_temperature_range": [-20, 30],
                "survival_temperature_range": [-20, 50]
              }
            ]
          },
          "hot_climate": {
            "type": "object",
            "description": "Define operating and survival temperatures in cold climates",
            "$comment": "Can we define why this is different in cold climates?",
            "properties": {
              "operating_temperature_range": {
                "type": "array",
                "items" : {
                  "type": "number",
                  "minimum": -273.15,
                  "maximum": 1000
                }
              },
              "survival_temperature_range": {
                "type": "array",
                "items" : {
                  "type": "number",
                  "minimum": -273.15,
                  "maximum": 1000
                }
              }
            },
            "examples": [
              {
                "operating_temperature_range": [-10, 45],
                "survival_temperature_range": [-20, 50]
              }
            ]
          }
        }
      }
    },
    "power_curves": {
      "type": "object",
      "title": "Power Curves",
      "description": "Contains power and thrust curves along with data specific to each operational mode of the turbine",
      "required": ["default_mode", "modes"],
      "properties": {
        "default_mode": {
          "type": "string",
          "title": "Default mode",
          "description": "The label of the mode that should be used by default (must match an entry in 'modes')",
          "minLength": 1,
          "maxLength": 40
        },
        "modes": {
          "type": "array",
          "title": "Modes",
          "description": "Different modes that the turbine can operate in / switch between",
          "additionalItems": true,
          "items": {
            "type": "object",
            "required": [
              "label",
              "name",
              "description",
              "design_bases",
              "cut",
              "parameters",
              "cp_is_coefficient",
              "ct_is_coefficient",
              "cp",
              "ct"
            ],
            "properties": {
              "label": {
                "type": "string",
                "title": "Mode label",
                "description": " A string key identifying the mode, e.g. `power_optimised_1`",
                "pattern": "^[a-z0-9_]{1,40}$",
                "minLength": 1,
                "maxLength": 40
              },
              "name": {
                "type": "string",
                "title": "Mode label",
                "description": " A human-readable name for the mode, e.g. `Power Optimised 1 (PO1)`",
                "minLength": 1,
                "maxLength": 40
              },
              "design_bases": {
                "type": "array",
                "description": "A list of the design basis labels relevant to this power curve",
                "items": {
                  "type": "string"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "description": {
                "type": "string",
                "title": "Mode description",
                "description": "Short human readable text which will be rendered into dropdowns and made searchable."
              },
              "rated_power": {
                "type": "number",
                "title": "Mode rated power (W)",
                "description": "Rated power of the turbine in this mode [W]"
              },
              "cut_in": {
                "title": "Cut in",
                "description": "A description of the cut in characteristics (a discontinuity in the power curve at low speeds)",
                "type": "object",
                "properties": {
                  "kind": {
                    "title": "Cut in characteristic",
                    "description": "Select the kind of cut in characteristic to apply",
                    "default": "cut_in_step",
                    "enum": [
                      "cut_in_step",
                      "cut_in_triangle",
                      "cut_in_recut_out"
                    ]
                  }
                },
                "allOf": [
                  {
                    "if": {
                      "properties": {
                        "kind": {
                          "const": "cut_in_step"
                        }
                      }
                    },
                    "then": {
                      "properties": {
                        "cut_in_speed": {
                          "title": "Cut in speed [m/s]",
                          "type": "number",
                          "default": 0
                        }
                      }
                    }
                  },
                  {
                    "if": {
                      "properties": {
                        "kind": {
                          "const": "cut_in_triangle"
                        }
                      }
                    },
                    "then": {
                      "properties": {
                        "cut_in_start_speed": {
                          "title": "Cut in ramp start speed [m/s]",
                          "type": "number"
                        },
                        "cut_in_end_speed": {
                          "title": "Cut in ramp end speed [m/s]",
                          "type": "number"
                        }
                      }
                    }
                  },
                  {
                    "if": {
                      "properties": {
                        "kind": {
                          "const": "cut_in_recut_out"
                        }
                      }
                    },
                    "then": {
                      "properties": {
                        "cut_in_speed": {
                          "title": "Cut in speed [m/s]",
                          "type": "number"
                        },
                        "recut_out_speed": {
                          "title": "Re-cut out speed [m/s]",
                          "description": "As wind speed decreases back to zero, this is the speed at which the turbine will cut out. Should be less than the cut in speed.",
                          "type": "number"
                        }
                      }
                    }
                  }
                ]
              },
              "cut_out": {
                "title": "Cut out",
                "description": "A description of the cut out characteristics (a discontinuity in the power curve at high wind speeds)",
                "type": "object",
                "properties": {
                  "kind": {
                    "title": "Cut out characteristic",
                    "description": "Select the kind of cut out characteristic to apply",
                    "default": "cut_out_step",
                    "enum": [
                      "cut_out_step",
                      "cut_out_triangle",
                      "cut_out_recut_in"
                    ]
                  }
                },
                "allOf": [
                  {
                    "if": {
                      "properties": {
                        "kind": {
                          "const": "cut_out_step"
                        }
                      }
                    },
                    "then": {
                      "properties": {
                        "cut_out_speed": {
                          "title": "Cut out speed [m/s]",
                          "description": "Wind speed above which the turbine is cut out, and below which it cuts back in",
                          "type": "number"
                        }
                      }
                    }
                  },
                  {
                    "if": {
                      "properties": {
                        "kind": {
                          "const": "cut_out_triangle"
                        }
                      }
                    },
                    "then": {
                      "properties": {
                        "start_speed": {
                          "title": "Cut out ramp start speed [m/s]",
                          "description": "Wind speed above which the power starts to ramp down",
                          "type": "number"
                        },
                        "end_speed": {
                          "title": "Cut out ramp end speed [m/s]",
                          "description": "Wind speed above which the cut out ramp is complete",
                          "type": "number"
                        }
                      }
                    }
                  },
                  {
                    "if": {
                      "properties": {
                        "kind": {
                          "const": "cut_out_recut_in"
                        }
                      }
                    },
                    "then": {
                      "properties": {
                        "cut_out_speed": {
                          "title": "Cut out speed [m/s]",
                          "description": "Wind speed above which the turbine is cut out",
                          "type": "number"
                        },
                        "recut_out_speed": {
                          "title": "Re-cut in speed [m/s]",
                          "description": "As wind speed decreases back toward zero, this is the speed at which the turbine will cut back in. Should be less than the cut out speed.",
                          "type": "number"
                        }
                      }
                    }
                  }
                ]
              },
              "parameters": {
                "type": "array",
                "title": "Parameters",
                "description": "Independent parameters for which the power curve is described",
                "additionalItems": true,
                "items": {
                  "type": "object",
                  "required": [
                    "label",
                    "dimension",
                    "values"
                  ],
                  "properties": {
                    "label": {
                      "type": "string",
                      "enum": [
                        "air-density",
                        "wind-speed",
                        "turbulence-intensity",
                        "turbulence-lengthscale",
                        "monin-obukhov-stability",
                        "shear-coefficient",
                        "wind-direction"
                      ],
                      "title": "Parameter label",
                      "description": "A slugified string key used to identify the parameter (e.g. air-density)."
                    },
                    "dimension": {
                      "type": "integer",
                      "title": "Dimension",
                      "description": "Dimension of the power curve array along which this parameter varies (0-based)"
                    }
                  },
                  "allOf": [
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "air-density"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number"
                            },
                            "title": "Air Density Values",
                            "description": "Values of air density [kg/m^3] for which this power curve is tabulated"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "wind-speed"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number"
                            },
                            "title": "Wind Speed Values",
                            "description": "Values of free-stream wind speed [m/s] at hub height for which this power curve is tabulated"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "turbulence-intensity"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number",
                              "minimum": 0,
                              "maximum": 1
                            },
                            "title": "Turbulence Intensity Values",
                            "description": "Values of turbulence intensity I [-] (expressed as a factor in the range 0,1 rather than a percentage) for which this power curve is tabulated"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "turbulence-lengthscale"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number"
                            },
                            "title": "Turbulence Lengthscale Values",
                            "description": "Values of turbulence integral lengthscale l [m] for which this power curve is tabulated"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "monin-obukhov-stability"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number"
                            },
                            "title": "Monin-Obukhov Stability Values",
                            "description": "Values of the the Monin-Obukhov stability parameter zeta [-] for which this power curve is tabulated. Values of zero indicate neutral conditions, vegative condi"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "shear-coefficient"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number"
                            },
                            "title": "Shear Coefficient Values",
                            "description": "Values of wind shear coefficient alpha [-] for which this power curve is tabulated"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "label": {
                            "const": "wind-direction"
                          }
                        }
                      },
                      "then": {
                        "properties": {
                          "values": {
                            "type": "array",
                            "additionalItems": true,
                            "items": {
                              "type": "number"
                            },
                            "title": "Wind Direction Values",
                            "description": "Values of wind direction [???? degrees clockwise from true north????] for which this power curve is tabulated"
                          }
                        },
                        "required": [
                          "values"
                        ]
                      }
                    }
                  ]
                }
              },
              "cp_is_coefficient": {
                "type": "boolean",
                "title": "Cp is Coefficient",
                "description": "True if the `cp` array is in nondimensional coefficient form, False if the `cp` array contains Power [W]."
              },
              "ct_is_coefficient": {
                "type": "boolean",
                "title": "Ct is Coefficient",
                "description": "True if the `ct` array is in nondimensional coefficient form, False if the `ct` array contains Thrust [kgms^-2]."
              },
              "cp": {
                "title": "Power Curve [cp]",
                "description": "The coefficient of power, defined as an N-D array at the sample points described in 'Parameters'",
                "oneOf": [
                  {
                    "title": "2 Parameters (2D Array, e.g. air-density and wind-speed)",
                    "type": "array",
                    "$ref": "#/definitions/2darray"
                  },
                  {
                    "title": "3 Parameters (3D Array, e.g. turbulent-intensity, air-density and wind-speed)",
                    "type": "array",
                    "$ref": "#/definitions/3darray"
                  },
                  {
                    "title": "4 Parameters (4D Array, e.g. monin-obukhov-stability, turbulent-intensity, air-density and wind-speed)",
                    "type": "array",
                    "$ref": "#/definitions/4darray"
                  }
                ]
              },
              "ct": {
                "title": "Thrust Curve [ct]",
                "description": "The coefficient of thrust, defined as an N-D array at the sample points described in 'Parameters'",
                "oneOf": [
                  {
                    "title": "2 Parameters (2D Array, e.g. air-density and wind-speed)",
                    "type": "array",
                    "$ref": "#/definitions/2darray"
                  },
                  {
                    "title": "3 Parameters (3D Array, e.g. turbulent-intensity, air-density and wind-speed)",
                    "type": "array",
                    "$ref": "#/definitions/3darray"
                  },
                  {
                    "title": "4 Parameters (4D Array, e.g. monin-obukhov-stability, turbulent-intensity, air-density and wind-speed)",
                    "type": "array",
                    "$ref": "#/definitions/4darray"
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  "additionalProperties": true
}
